<?xml version="1.0" ?>
<sdf version="1.8">
    <world name="day9_diff_drive_world">
        <plugin name="gz::sim::systems::Physics" filename="gz-sim-physics-system"/>
        <plugin name="gz::sim::systems::UserCommands" filename="gz-sim-user-commands-system"/>
        <plugin name="gz::sim::systems::SceneBroadcaster" filename="gz-sim-scene-broadcaster-system"/>

        <light type="directional" name="sun">
            <cast_shadows>true</cast_shadows>
            <pose>0 0 10 0 0 0</pose>
            <diffuse>0.8 0.8 0.8 1</diffuse>
            <specular>0.2 0.2 0.2 1</specular>
            <direction>-0.5 0.1 -0.9</direction>
        </light>

        <model name="ground_plane">
            <static>true</static>
            <link name="link">
                <collision name="collision">
                    <geometry>
                        <plane><normal>0 0 1</normal><size>100 100</size></plane>
                    </geometry>
                </collision>
                <visual name="visual">
                    <geometry>
                        <plane><normal>0 0 1</normal><size>100 100</size></plane>
                    </geometry>
                    <material>
                        <ambient>0.8 0.8 0.8 1</ambient>
                        <diffuse>0.8 0.8 0.8 1</diffuse>
                        <specular>0.8 0.8 0.8 1</specular>
                    </material>
                </visual>
            </link>
        </model>

        <model name='simple_car'>
            <pose>0 0 0.5 0 0 0</pose>

            <link name='chassis'>
                <inertial>
                    <mass>6.0</mass>
                    <inertia>
                        <ixx>0.625</ixx><ixy>0</ixy><ixz>0</ixz>
                        <iyy>2.125</iyy><iyz>0</iyz>
                        <izz>2.5</izz>
                    </inertia>
                </inertial>
                
                <visual name='visual'>
                    <geometry><box><size>2.0 1.0 0.5</size></box></geometry>
                    <material><ambient>0.0 0.0 1.0 1</ambient><diffuse>0.0 0.0 1.0 1</diffuse></material>
                </visual>
                
                <visual name='front_nose'>
                    <pose>1.0 0 0 0 0 0</pose>
                    <geometry><box><size>0.2 0.8 0.2</size></box></geometry>
                    <material><ambient>1.0 0.0 0.0 1</ambient><diffuse>1.0 0.0 0.0 1</diffuse></material>
                </visual>

                <collision name='collision'>
                    <geometry><box><size>2.0 1.0 0.5</size></box></geometry>
                </collision>
            </link>

            <link name='left_wheel'>
                <pose>0.6 0.6 0 1.5707 0 0</pose>
                <inertial>
                    <mass>1.0</mass>
                    <inertia>
                        <ixx>0.0433</ixx><ixy>0</ixy><ixz>0</ixz>
                        <iyy>0.0433</iyy><iyz>0</iyz>
                        <izz>0.08</izz>
                    </inertia>
                </inertial>
                <visual name='visual'>
                    <geometry><cylinder><radius>0.4</radius><length>0.2</length></cylinder></geometry>
                    <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
                </visual>
                <collision name='collision'>
                    <geometry><cylinder><radius>0.4</radius><length>0.2</length></cylinder></geometry>
                </collision>
            </link>

            <link name='right_wheel'>
                <pose>0.6 -0.6 0 1.5707 0 0</pose>
                <inertial>
                    <mass>1.0</mass>
                    <inertia>
                        <ixx>0.0433</ixx><ixy>0</ixy><ixz>0</ixz>
                        <iyy>0.0433</iyy><iyz>0</iyz>
                        <izz>0.08</izz>
                    </inertia>
                </inertial>
                <visual name='visual'>
                    <geometry><cylinder><radius>0.4</radius><length>0.2</length></cylinder></geometry>
                    <material><ambient>0.1 0.1 0.1 1</ambient><diffuse>0.1 0.1 0.1 1</diffuse></material>
                </visual>
                <collision name='collision'>
                    <geometry><cylinder><radius>0.4</radius><length>0.2</length></cylinder></geometry>
                </collision>
            </link>

            <link name='caster'>
                <pose>-0.8 0 -0.2 0 0 0</pose>
                <inertial>
                    <mass>1.0</mass>
                    <inertia>
                        <ixx>0.016</ixx><ixy>0</ixy><ixz>0</ixz>
                        <iyy>0.016</iyy><iyz>0</iyz>
                        <izz>0.016</izz>
                    </inertia>
                </inertial>
                <visual name='visual'>
                    <geometry><sphere><radius>0.2</radius></sphere></geometry>
                    <material><ambient>0.5 0.5 0.5 1</ambient><diffuse>0.5 0.5 0.5 1</diffuse></material>
                </visual>
                <collision name='collision'>
                    <geometry><sphere><radius>0.2</radius></sphere></geometry>
                    <surface>
                        <friction>
                            <ode><mu>0.0</mu><mu2>0.0</mu2></ode>
                        </friction>
                    </surface>
                </collision>
            </link>

            <joint name='left_wheel_joint' type='revolute'>
                <parent>chassis</parent>
                <child>left_wheel</child>
                <axis>
                    <xyz>0 0 -1</xyz> <limit><lower>-1e16</lower><upper>1e16</upper></limit>
                </axis>
            </joint>

            <joint name='right_wheel_joint' type='revolute'>
                <parent>chassis</parent>
                <child>right_wheel</child>
                <axis>
                    <xyz>0 0 -1</xyz> <limit><lower>-1e16</lower><upper>1e16</upper></limit>
                </axis>
            </joint>

            <joint name='caster_joint' type='ball'>
                <parent>chassis</parent>
                <child>caster</child>
            </joint>

            <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
                <left_joint>left_wheel_joint</left_joint>
                <right_joint>right_wheel_joint</right_joint>
                <wheel_separation>1.2</wheel_separation>
                <wheel_radius>0.4</wheel_radius>
                <odom_publish_frequency>50</odom_publish_frequency> <topic>/cmd_vel</topic>
            </plugin>
        </model>
    </world>
</sdf>
